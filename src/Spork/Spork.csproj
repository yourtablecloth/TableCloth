<Project Sdk="Microsoft.NET.Sdk">

	<PropertyGroup>
		<OutputType>WinExe</OutputType>
		<TargetFramework>net48</TargetFramework>
		<RootNamespace>Spork</RootNamespace>
		<AssemblyName>Spork</AssemblyName>
		<UseWPF>true</UseWPF>
		<Platforms>x64;ARM64</Platforms>
		<UseWindowsForms>false</UseWindowsForms>
		<LangVersion>12.0</LangVersion>
		<Deterministic>true</Deterministic>
		<AutoGenerateBindingRedirects>true</AutoGenerateBindingRedirects>
		<GenerateResourceUsePreserializedResources>true</GenerateResourceUsePreserializedResources>
		<StartupObject>Spork.Program</StartupObject>
		<ApplicationIcon>App.ico</ApplicationIcon>
		<ApplicationManifest>app.manifest</ApplicationManifest>
		<RunPostBuildEvent>Always</RunPostBuildEvent>
		<DefineConstants>$(DefineConstants);NETFX</DefineConstants>

		<!-- Assembly Info -->
		<Title>TableCloth Spork</Title>
		<Description>This program is a tool that installs the requested installers at once in the sandbox.</Description>

		<!-- COM Interop -->
		<ComVisible>true</ComVisible>
	</PropertyGroup>

	<!-- GUID for COM Interop -->
	<ItemGroup>
		<AssemblyAttribute Include="System.Runtime.InteropServices.GuidAttribute">
			<_Parameter1>36e7b617-ca94-4ecb-ad65-39fe94ce265b</_Parameter1>
		</AssemblyAttribute>
	</ItemGroup>

	<PropertyGroup Condition="'$(Configuration)' == 'Debug'">
		<DefineConstants>$(DefineConstants);TRACE;DEBUG</DefineConstants>
		<DebugType>full</DebugType>
		<DebugSymbols>true</DebugSymbols>
	</PropertyGroup>

	<PropertyGroup Condition="'$(Configuration)' == 'Release'">
		<DefineConstants>$(DefineConstants);TRACE</DefineConstants>
		<Optimize>true</Optimize>
		<DebugType>pdbonly</DebugType>
	</PropertyGroup>

	<PropertyGroup Condition="'$(Platform)' == 'x64'">
		<PlatformTarget>x64</PlatformTarget>
	</PropertyGroup>

	<PropertyGroup Condition="'$(Platform)' == 'ARM64'">
		<PlatformTarget>ARM64</PlatformTarget>
	</PropertyGroup>

	<ItemGroup>
		<PackageReference Include="AsyncAwaitBestPractices" Version="7.0.0" />
		<PackageReference Include="AsyncAwaitBestPractices.MVVM" Version="7.0.0" />
		<PackageReference Include="CommunityToolkit.Mvvm" Version="8.4.0" />
		<PackageReference Include="Microsoft.Extensions.Configuration" Version="8.0.0" />
		<PackageReference Include="Microsoft.Extensions.Configuration.Binder" Version="8.0.2" />
		<PackageReference Include="Microsoft.Extensions.Configuration.CommandLine" Version="8.0.0" />
		<PackageReference Include="Microsoft.Extensions.Configuration.EnvironmentVariables" Version="8.0.0" />
		<PackageReference Include="Microsoft.Extensions.Configuration.Json" Version="8.0.1" />
		<PackageReference Include="Microsoft.Extensions.Configuration.UserSecrets" Version="8.0.1" />
		<PackageReference Include="Microsoft.Extensions.DependencyInjection" Version="8.0.1" />
		<PackageReference Include="Microsoft.Extensions.Hosting" Version="8.0.1" />
		<PackageReference Include="Microsoft.Extensions.Http" Version="8.0.1" />
		<PackageReference Include="Microsoft.Extensions.Logging" Version="8.0.1" />
		<PackageReference Include="Microsoft.Extensions.Logging.Console" Version="8.0.1" />
		<PackageReference Include="Microsoft.Extensions.Logging.Debug" Version="8.0.1" />
		<PackageReference Include="Microsoft.Extensions.Logging.EventLog" Version="8.0.1" />
		<PackageReference Include="Microsoft.Xaml.Behaviors.Wpf" Version="1.1.77" />
		<PackageReference Include="Mono.HttpUtility" Version="1.0.0.1" />
		<PackageReference Include="Sentry" Version="3.41.4" />
		<PackageReference Include="Sentry.Serilog" Version="3.41.4" />
		<PackageReference Include="Serilog" Version="3.1.1" />
		<PackageReference Include="Serilog.Extensions.Logging" Version="8.0.0" />
		<PackageReference Include="System.CommandLine" Version="2.0.0-beta4.22272.1" />
		<PackageReference Include="System.Text.Json" Version="8.0.5" />
		<!-- Explicit versions to resolve MSB3277 conflicts -->
		<PackageReference Include="System.Collections.Immutable" Version="8.0.0" />
		<PackageReference Include="System.Reflection.Metadata" Version="8.0.0" />
		<PackageReference Include="System.Resources.Extensions" Version="8.0.0" />
		<PackageReference Include="Microsoft.Extensions.Configuration.Abstractions" Version="8.0.0" />
		<PackageReference Include="Microsoft.Extensions.DependencyInjection.Abstractions" Version="8.0.2" />
		<PackageReference Include="Microsoft.Extensions.Logging.Abstractions" Version="8.0.2" />
		<PackageReference Include="Microsoft.Extensions.Options" Version="8.0.2" />
		<PackageReference Include="Microsoft.Extensions.Primitives" Version="8.0.0" />
	</ItemGroup>

	<ItemGroup>
		<Reference Include="PresentationFramework.Aero2" />
		<Reference Include="System.ComponentModel.DataAnnotations" />
		<Reference Include="System.Drawing" />
		<Reference Include="System.ServiceProcess" />
		<Reference Include="UIAutomationProvider" />
	</ItemGroup>

	<ItemGroup>
		<Resource Include="App.ico" />
	</ItemGroup>

	<ItemGroup>
		<None Include="Resources\Signature.jpg" />
	</ItemGroup>

	<ItemGroup>
	  <ProjectReference Include="..\TableCloth.Core\TableCloth.Core.csproj" />
	</ItemGroup>

	<Target Name="PreBuild" BeforeTargets="PreBuildEvent">
		<Exec Command="git.exe rev-parse HEAD &gt; &quot;$(ProjectDir)commit.txt&quot;" />
	</Target>

	<Target Name="PostBuild" AfterTargets="PostBuildEvent">
		<Exec Command="if not exist &quot;$(TargetDir)System.Runtime.InteropServices.RuntimeInformation.dll&quot; copy /y &quot;$(SolutionDir)packages\System.Runtime.InteropServices.RuntimeInformation.4.3.0\lib\net45\System.Runtime.InteropServices.RuntimeInformation.dll&quot; &quot;$(TargetDir)System.Runtime.InteropServices.RuntimeInformation.dll&quot;&#xD;&#xA;&#xD;&#xA;echo Compressing '$(TargetDir)' into '$(SolutionDir)Artifacts\$(ProjectName).zip'...&#xD;&#xA;if not exist &quot;$(SolutionDir)Artifacts\&quot; mkdir &quot;$(SolutionDir)Artifacts\&quot;&#xD;&#xA;if exist &quot;$(SolutionDir)Artifacts\$(ProjectName).zip&quot; del /f /q &quot;$(SolutionDir)Artifacts\$(ProjectName).zip&quot;&#xD;&#xA;powershell.exe Add-Type -AssemblyName 'System.IO.Compression.FileSystem'; [IO.Compression.ZipFile]::CreateFromDirectory('$(TargetDir)', '$(SolutionDir)Artifacts\$(ProjectName).zip')&#xD;&#xA;dir $(SolutionDir)Artifacts\$(ProjectName).zip" />
	</Target>

</Project>